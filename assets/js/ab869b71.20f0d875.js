"use strict";(self.webpackChunkupstairs_0102_github_io=self.webpackChunkupstairs_0102_github_io||[]).push([[5167],{3905:(e,n,t)=>{t.d(n,{Zo:()=>m,kt:()=>k});var a=t(67294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var p=a.createContext({}),s=function(e){var n=a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},m=function(e){var n=s(e.components);return a.createElement(p.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},c=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,p=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),u=s(t),c=i,k=u["".concat(p,".").concat(c)]||u[c]||d[c]||r;return t?a.createElement(k,l(l({ref:n},m),{},{components:t})):a.createElement(k,l({ref:n},m))}));function k(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,l=new Array(r);l[0]=c;var o={};for(var p in n)hasOwnProperty.call(n,p)&&(o[p]=n[p]);o.originalType=e,o[u]="string"==typeof e?e:i,l[1]=o;for(var s=2;s<r;s++)l[s]=t[s];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}c.displayName="MDXCreateElement"},48154:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>o,toc:()=>s});var a=t(87462),i=(t(67294),t(3905));const r={slug:"/js-build-tools/using-vite-to-build-node-packages",title:"[\u4e3b\u984c] \u7528vite\u6253\u5305\u8981\u767c\u5e03npm\u7684\u7a0b\u5f0f",tags:["vite","npm"]},l=void 0,o={unversionedId:"JS Modules & Build Tools/[\u4e3b\u984c] \u7528vite\u6253\u5305\u8981\u767c\u5e03npm\u7684\u7a0b\u5f0f",id:"JS Modules & Build Tools/[\u4e3b\u984c] \u7528vite\u6253\u5305\u8981\u767c\u5e03npm\u7684\u7a0b\u5f0f",title:"[\u4e3b\u984c] \u7528vite\u6253\u5305\u8981\u767c\u5e03npm\u7684\u7a0b\u5f0f",description:"\u524d\u60c5\u63d0\u8981\uff0c\u5148\u524d\u5beb\u904e\u4e00\u7bc7\u95dc\u65bc\u767c\u5e03npm\u7684\u6587\u7ae0\u300c\u7b2c\u4e00\u6b21\u767c\u5e03npm\u5957\u4ef6\u5c31\u4e0a\u624b\u300d\uff0c\u7576\u6642\u662f\u91dd\u5c0d\u767c\u5e03\u5957\u4ef6\u7a0b\u5f0f\u6642\u5168\u90e8\u6d41\u7a0b\u4e2d\u6240\u9700\u8981\u76f8\u95dc\u8a2d\u5b9a\uff0c\u4f7f\u7528\u7684\u7bc4\u4f8b\u662f\u4e00\u500b\u6bd4\u8f03\u57fa\u672c\u7684\u60c5\u6cc1 - \u4e5f\u5c31\u662f\u76f4\u63a5\u767c\u5e03 Source Code\uff08\u672a\u6253\u5305\u6216\u7de8\u8b6f\u7684\u7a0b\u5f0f\uff09\u3002",source:"@site/docs/JS Modules & Build Tools/[\u4e3b\u984c] \u7528vite\u6253\u5305\u8981\u767c\u5e03npm\u7684\u7a0b\u5f0f.md",sourceDirName:"JS Modules & Build Tools",slug:"/js-build-tools/using-vite-to-build-node-packages",permalink:"/docs/js-build-tools/using-vite-to-build-node-packages",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/JS Modules & Build Tools/[\u4e3b\u984c] \u7528vite\u6253\u5305\u8981\u767c\u5e03npm\u7684\u7a0b\u5f0f.md",tags:[{label:"vite",permalink:"/docs/tags/vite"},{label:"npm",permalink:"/docs/tags/npm"}],version:"current",frontMatter:{slug:"/js-build-tools/using-vite-to-build-node-packages",title:"[\u4e3b\u984c] \u7528vite\u6253\u5305\u8981\u767c\u5e03npm\u7684\u7a0b\u5f0f",tags:["vite","npm"]},sidebar:"tutorialSidebar",previous:{title:"[\u4e3b\u984c] \u5f9eD3.js\u7684select(this)\u63a2\u8a0e\u7684\u51fd\u5f0f\u4e2d\u7684this\u6307\u5411",permalink:"/docs/d3/d3js-select-this"},next:{title:"[\u4e3b\u984c] \u7b2c\u4e00\u6b21\u767c\u5e03npm\u524d\u7aef\u5957\u4ef6\u5c31\u4e0a\u624b",permalink:"/docs/js-build-tools/publish-js-library-to-npm"}},p={},s=[{value:"\u6253\u5305\u4e0d\u6253\u5305\u7684\u5dee\u5225",id:"\u6253\u5305\u4e0d\u6253\u5305\u7684\u5dee\u5225",level:2},{value:"\u767c\u5e03 Node Packages \u7684\u8a2d\u5b9a",id:"\u767c\u5e03-node-packages-\u7684\u8a2d\u5b9a",level:2},{value:"vite\u6253\u5305\u8a2d\u5b9a",id:"vite\u6253\u5305\u8a2d\u5b9a",level:2},{value:"\u4f7f\u7528 vite-plugin-dts\u81ea\u52d5\u751f\u6210 .d.ts\u578b\u5225",id:"\u4f7f\u7528-vite-plugin-dts\u81ea\u52d5\u751f\u6210-dts\u578b\u5225",level:3},{value:"packages \u6253\u5305\u76f8\u95dc\u8a2d\u5b9a",id:"packages-\u6253\u5305\u76f8\u95dc\u8a2d\u5b9a",level:3},{value:"Demo\u7db2\u7ad9\u6253\u5305\u53ca\u5e03\u7f72\u8a2d\u5b9a",id:"demo\u7db2\u7ad9\u6253\u5305\u53ca\u5e03\u7f72\u8a2d\u5b9a",level:2},{value:"Demo\u9801\u6253\u5305\u8cc7\u6599\u593e\u8def\u5f91",id:"demo\u9801\u6253\u5305\u8cc7\u6599\u593e\u8def\u5f91",level:3},{value:"Demo\u9801\u548cPackage\u7684\u6253\u5305\u5206\u958b\u4f86",id:"demo\u9801\u548cpackage\u7684\u6253\u5305\u5206\u958b\u4f86",level:3},{value:"Reference",id:"reference",level:2}],m={toc:s};function u(e){let{components:n,...t}=e;return(0,i.kt)("wrapper",(0,a.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"\u524d\u60c5\u63d0\u8981\uff0c\u5148\u524d\u5beb\u904e\u4e00\u7bc7\u95dc\u65bc\u767c\u5e03npm\u7684\u6587\u7ae0\u300c",(0,i.kt)("a",{parentName:"p",href:"https://upstairs0102.github.io/docs/js-build-tools/publish-js-library-to-npm"},"\u7b2c\u4e00\u6b21\u767c\u5e03npm\u5957\u4ef6\u5c31\u4e0a\u624b"),"\u300d\uff0c\u7576\u6642\u662f\u91dd\u5c0d\u767c\u5e03\u5957\u4ef6\u7a0b\u5f0f\u6642\u5168\u90e8\u6d41\u7a0b\u4e2d\u6240\u9700\u8981\u76f8\u95dc\u8a2d\u5b9a\uff0c\u4f7f\u7528\u7684\u7bc4\u4f8b\u662f\u4e00\u500b\u6bd4\u8f03\u57fa\u672c\u7684\u60c5\u6cc1 - \u4e5f\u5c31\u662f\u76f4\u63a5\u767c\u5e03 Source Code\uff08\u672a\u6253\u5305\u6216\u7de8\u8b6f\u7684\u7a0b\u5f0f\uff09\u3002"),(0,i.kt)("p",null,"\u4f46\u9084\u6709\u53e6\u5916\u4e00\u7a2e\u60c5\u6cc1\u662f\u9700\u8981\u6253\u5305\u7a0b\u5f0f\u7684\u60c5\u5f62\u3002\u6240\u8b02\u7684\u6253\u5305\u7a0b\u5f0f\uff0c\u4e5f\u5c31\u662f\u900f\u904e Webpack \u6216 Vite \u7b49\u5de5\u5177\u505a minify\u3001uglify\u3001\u6216\u8005Typescript/SCSS\u7b49\u7684\u7a0b\u5f0f\u7de8\u8b6f\uff0c\u5c07\u6a21\u7d44\u5316\u7684 Source Code \u8f38\u51fa\u6210\u4e00\u5305\u4e00\u5305\u7684 bundle\u7a0b\u5f0f\u3002"),(0,i.kt)("p",null,"\u73fe\u4ee3\u7684\u524d\u7aef\u6846\u67b6\u5982 React\u3001Vue\u7b49\u57fa\u672c\u4e0a\u90fd\u5df2\u5167\u5efa Webpack \u6216 Vite\uff0c\u4ee5\u672c\u6587\u4f86\u8aaa\u5c31\u662f\u4f7f\u7528 Vue3\u5c08\u6848\uff08\u4f7f\u7528 Vite\uff09\u4f86\u4f5c\u70ba\u7bc4\u4f8b\uff0c\u4f46\u7121\u8ad6\u662f\u8981\u4f7f\u7528\u5176\u5b83\u524d\u7aef\u6846\u67b6\u3001\u53c8\u6216\u8005\u4e0d\u4f7f\u7528\u6846\u67b6\uff0c\u548c\u672c\u6587\u8a2d\u5b9a\u65b9\u5f0f\u4e0d\u6703\u6709\u6240\u5dee\u7570\uff0c\u56e0\u70ba\u4e3b\u8981\u9700\u8981\u8a2d\u7f6e\u7684\u662f vite\u7684 config \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"packages.json"),"\uff0c\u8ddf\u4f7f\u7528\u4ec0\u9ebc\u6846\u67b6\u4e26\u4e0d\u6703\u6709\u6240\u5f71\u97ff\uff1b\u4f46\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f Webpack\u7684\u8a71\u5c31\u6703\u6709\u6bd4\u8f03\u5927\u7684\u5dee\u7570\u7121\u6cd5\u76f4\u63a5\u5957\u7528\u4e86\u3002"),(0,i.kt)("h2",{id:"\u6253\u5305\u4e0d\u6253\u5305\u7684\u5dee\u5225"},"\u6253\u5305\u4e0d\u6253\u5305\u7684\u5dee\u5225"),(0,i.kt)("p",null,"\u767c\u5e03 Node Packages \u5230 npm \u8981\u4e0d\u8981\u505a\u6253\u5305\uff0c\u6211\u81ea\u5df1\u8a8d\u70ba\u4e3b\u8981\u7684\u5dee\u5225\u662f\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u767c\u5e03 Source Code\uff1a\u5b89\u88dd node package\u7684\u5c08\u6848\u5982\u679c\u9047\u5230\u9700\u8981 debug\u6216 trace code\u7684\u60c5\u6cc1\u662f\u6703\u6bd4\u8f03\u65b9\u4fbf\u7684\uff0c\u672a\u7d93\u904e\u7de8\u8b6f\u7684\u7a0b\u5f0f\u78bc\u65b9\u4fbf\u958b\u767c\u8005\u53ef\u76f4\u63a5\u9032\u53bb\u958b\u555f\u7a0b\u5f0f\u3001\u751a\u81f3\u5728\u700f\u89bd\u5668\u4e2d\u4e0b\u65b7\u9ede\u90fd\u662f\u53ef\u884c\u7684\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u767c\u5e03\u6253\u5305\u904e\u7684\u7a0b\u5f0f\u78bc\uff1a\u6253\u5305\u53ef\u4ee5\u505a minify\u3001uglify\u3001\u6216\u8005Typescript/SCSS\u7b49\u7684\u7a0b\u5f0f\u7de8\u8b6f\u7b49\uff1b\u5728\u767c\u5e03\u524d\u505a\u9019\u4e9b\u524d\u8655\u7406\u901a\u5e38\u6709\u5169\u7a2e\u9700\u6c42\uff0c\u4e00\u662f\u4fdd\u8b77\u7a0b\u5f0f\u78bc\u3001\u4e0d\u88ab\u8f15\u6613\u7684\u95b1\u8b80\uff0c\u53e6\u5916\u662f\u900f\u904e\u7a0b\u5f0f\u7de8\u8b6f\u6e1b\u4f4e\u5c0d\u5916\u90e8 library\u7684\u4f9d\u8cf4\u3002")),(0,i.kt)("h2",{id:"\u767c\u5e03-node-packages-\u7684\u8a2d\u5b9a"},"\u767c\u5e03 Node Packages \u7684\u8a2d\u5b9a"),(0,i.kt)("p",null,"\u96d6\u7136\u672c\u6587\u4e3b\u984c\u662f Vite\u6253\u5305\uff0c\u4f46\u7562\u7adf\u6700\u7d42\u76ee\u7684\u9084\u662f\u8981\u767c\u5e03\u4e0a npm\uff0c\u4e00\u4e9b\u57fa\u672c\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"packages.json")," \u8a2d\u5b9a\u9084\u662f\u9700\u8981\u4e86\u89e3\u4e00\u4e0b\uff0c\u7bc4\u4f8b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'// package.json\n{\n  "name": "my-library",\n  "version": "1.0.0",\n  "description": "My Node Packages Setting Example",\n  "author": "Adam You <upstairs0102@gmail.com>",\n  "license": "MIT",\n  "private": fasle,\n  "keywords": [\n    "vue",\n    "component",\n  ],\n  "main": "lib/main.js",\n  "files": [\n    "lib/*",\n    "src/components/*"\n  ]\n}\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"name"),"\uff1anode package \u7684\u540d\u7a31\uff08\u767c\u5e03\u81f3 npm\u4e0a\u6240\u4f7f\u7528\u7684\u540d\u7a31\uff09\u3002"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"version"),"\uff1a\u7248\u672c\u865f\u3002\u6bcf\u6b21\u767c\u5e03\u90fd\u8981\u5927\u65bc\u904e\u53bb\u7684\u7248\u672c\uff0c\u5426\u5247\u5c31\u6703\u767c\u5e03\u5931\u6557\u3002"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"main"),"\uff1anode package \u7684\u5165\u53e3\u6a94\u3002"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"files"),"\uff1a\u6b04\u4f4d\u662f\u8a2d\u5b9a node package\u7684\u6a94\u6848\u7bc4\u570d\uff0c\u540c\u6642\u4e5f\u662f\u6703\u767c\u5e03\u81f3 npm\u7684\u6a94\u6848\uff1b\u5982\u679c\u6b64\u6b04\u4f4d\u6c92\u6709\u8a2d\u5b9a\u9810\u8a2d\u6703\u767c\u5e03\u6240\u6709\u7684\u6a94\u6848\u3002"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"private"),": \u8a2d\u70ba ",(0,i.kt)("inlineCode",{parentName:"li"},"false")," \u624d\u53ef\u4ee5\u767c\u5e03\u5230 npm\u3002")),(0,i.kt)("h2",{id:"vite\u6253\u5305\u8a2d\u5b9a"},"vite\u6253\u5305\u8a2d\u5b9a"),(0,i.kt)("h3",{id:"\u4f7f\u7528-vite-plugin-dts\u81ea\u52d5\u751f\u6210-dts\u578b\u5225"},"\u4f7f\u7528 vite-plugin-dts\u81ea\u52d5\u751f\u6210 .d.ts\u578b\u5225"),(0,i.kt)("p",null,"\u900f\u904e\u6253\u5305\u5c07 .ts\u6a94\u7de8\u8b6f\u6210 .js\u6a94\u4e4b\u5f8c\u5c31\u6c92\u6709 typescript\u7684\u578b\u5225\u63a8\u65b7\uff0c\u9019\u6642\u5019\u53ef\u4ee5\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"vite-plugin-dts")," \u5de5\u5177\u81ea\u52d5\u7522\u751f .d.ts\u3002\u7576\u7136 .d.ts\u4e5f\u53ef\u4ee5\u81ea\u5df1\u5beb\u4e0d\u4e00\u5b9a\u8981\u4f9d\u8cf4\u5de5\u5177"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"npm i -D sass vite-plugin-dts\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"vite.config.js")," ",(0,i.kt)("inlineCode",{parentName:"p"},"dts"),"\u8a2d\u5b9a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"import dts from 'vite-plugin-dts'\n\nexport default defineConfig({\n  plugins: [\n    dts()\n  ],\n})\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"tsconfig.json")," \u91dd\u5c0d ",(0,i.kt)("inlineCode",{parentName:"p"},"dts")," \u505a\u4fee\u6b63\uff0c\u9019\u662f\u6211\u81ea\u5df1\u6e2c\u51fa\u4f86\u7684\u7d50\u679c\uff08\u4e0d\u592a\u6e05\u695a\u5177\u9ad4\u539f\u56e0\uff09\uff0c\u5982\u679c\u6c92\u52a0\u7684\u8a71\u6253\u5305\u51fa\u4f86\u6703\u7de8\u8b6f\u4e0d\u51fa ",(0,i.kt)("inlineCode",{parentName:"p"},".d.ts")," \u6a94"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'{\n  "compilerOptions": {\n    "composite": true\n  }\n}\n')),(0,i.kt)("h3",{id:"packages-\u6253\u5305\u76f8\u95dc\u8a2d\u5b9a"},"packages \u6253\u5305\u76f8\u95dc\u8a2d\u5b9a"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"vite.config.js")," \u6253\u5305\u8a2d\u5b9a\uff08\u7bc4\u4f8b\uff09"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'import { resolve } from \'path\'\n\nexport default defineConfig({\n  build: {\n    lib: {\n      entry: "src/main.ts",\n      name: \'myLibrary\',\n      formats: ["es", "cjs", "umd"],\n      fileName: format => `my-library.${format}.js`\n    },\n    rollupOptions: {\n      input: {\n        main: resolve(__dirname, "src/main.ts")\n      },\n      external: [\'vue\'],\n      output: {\n        assetFileNames: \'my-library.css\',\n        exports: "named",\n        globals: {\n          vue: \'Vue\',\n        },\n      },\n    },\n  },\n})\n')),(0,i.kt)("p",null,"\u5728\u4ee5\u4e0a\u7bc4\u4f8b\u4e2d\uff0c\u6703\u4f9d\u7167 lib/formats \u4e2d\u7684\u8a2d\u5b9a\u7522\u751f ",(0,i.kt)("inlineCode",{parentName:"p"},"my-library.es.js"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"my-library.cjs.js"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"my-library.umd.js")," \u4e09\u500b\u6a94\u6848\uff0c\u5206\u5225\u662f ESM, CommonJS, UMD \u4e09\u7a2e\u7684 JS\u6a21\u7d44\u5316\u898f\u7bc4\u3002"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"packages.json")," \u6b04\u4f4d\u8cc7\u8a0a\uff08\u7bc4\u4f8b\uff09"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "my-library",\n  "version": "1.0.0",\n  "description": "My Node Packages Setting Example",\n  "author": "Adam You <upstairs0102@gmail.com>",\n  "license": "MIT",\n  "private": fasle,\n  "keywords": [\n    "vue",\n    "component",\n  ],\n  "files": [\n    "dist",\n    "README.md"\n  ],\n  "main": "./dist/my-library.umd.js",\n  "module": "./dist/my-library.es.js",\n  "exports": {\n    ".": {\n      "import": "./dist/my-library.es.js",\n      "require": "./dist/my-library.umd.js"\n    },\n    "./dist/my-library.css": {\n      "import": "./dist/my-library.css",\n      "require": "./dist/my-library.css"\n    }\n  },\n  "types": "./dist/main.d.ts",\n}\n')),(0,i.kt)("p",null,"\u5728\u524d\u4e00\u500b\u7ae0\u7bc0\u6211\u5011\u53ea\u4f7f\u7528\u4e86 ",(0,i.kt)("inlineCode",{parentName:"p"},"main")," \u4f86\u5ba3\u544a\u5165\u53e3\u7a0b\u5f0f\uff0c\u6211\u5011\u9084\u53ef\u4ee5\u9078\u64c7\u4f7f\u7528\uff08\u6709\u9700\u7684\u8a71\uff09",(0,i.kt)("inlineCode",{parentName:"p"},"module")," \u53ca ",(0,i.kt)("inlineCode",{parentName:"p"},"browser"),"\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"main"),"\uff1a\u901a\u7528\u7684\u5165\u53e3\u6a94\u6848\u8a2d\u5b9a"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"module"),"\uff1aESM \u7684\u5165\u53e3\u6a94\u6848"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"browser"),"\uff1a\u9650\u5b9a browser\u74b0\u5883\u4f7f\u7528\u7684\u5165\u53e3\u6a94\u6848")),(0,i.kt)("p",null,"\u53e6\u5916\u9019\u908a\u9084\u591a\u8a2d\u5b9a\u4e86\u4e00\u500b ",(0,i.kt)("inlineCode",{parentName:"p"},"exports")," \u6b04\u4f4d\uff0c\u53ef\u4ee5\u9650\u5236\u54ea\u4e9b\u6a94\u6848\u53ef\u4ee5\u88ab export\u51fa\u4f86\u3002"),(0,i.kt)("h2",{id:"demo\u7db2\u7ad9\u6253\u5305\u53ca\u5e03\u7f72\u8a2d\u5b9a"},"Demo\u7db2\u7ad9\u6253\u5305\u53ca\u5e03\u7f72\u8a2d\u5b9a"),(0,i.kt)("p",null,"\u958b\u767c\u4e00\u500b npm\u5957\u4ef6\u9664\u4e86\u767c\u5e03\u7a0b\u5f0f\u78bc\u4e0a\u53bb\u4e4b\u5916\uff0c\u4e5f\u5e38\u6703\u5728 Github\u4e0a\u653e\u7f6e\u6587\u4ef6\u4ee5\u53ca\u5c55\u793a\u9801\u9762\u3002"),(0,i.kt)("p",null,"\u7576\u7136 Demo\u7db2\u7ad9\u4e5f\u53ef\u4ee5\u9078\u64c7\u5728\u53e6\u4e00\u500b\u7368\u7acb\u7684\u5c08\u6848\u4e2d\u958b\u767c\uff0c\u4f46\u5982\u679c\u60f3\u8b93\u5169\u8005\u5171\u7528\u540c\u4e00\u4efd\u8981\u767c\u5e03\u5957\u4ef6\u7684\u7a0b\u5f0f\u78bc\uff0c\u4e26\u4e14\u66f4\u5927\u7a0b\u5f0f\u5171\u4eab\u76f8\u540c\u7684\u4f9d\u8cf4\uff0c\u4f7f\u7528\u540c\u4e00\u4efd ",(0,i.kt)("inlineCode",{parentName:"p"},"packages.json")," \u662f\u4e00\u500b\u4e0d\u932f\u7684\u505a\u6cd5\u3002"),(0,i.kt)("h3",{id:"demo\u9801\u6253\u5305\u8cc7\u6599\u593e\u8def\u5f91"},"Demo\u9801\u6253\u5305\u8cc7\u6599\u593e\u8def\u5f91"),(0,i.kt)("p",null,"\u6253\u5305\u51fa\u4f86\u7684\u7a0b\u5f0f\u9810\u8a2d\u6703\u88ab\u653e\u5230 ",(0,i.kt)("inlineCode",{parentName:"p"},"dist")," \u8cc7\u6599\u593e\u4e2d\uff0c\u5728\u524d\u9762\u6211\u5011\u6253\u5305\u5957\u4ef6\u7a0b\u5f0f\u7684\u6642\u5019\u4e26\u6c92\u6709\u66f4\u6539\u8a2d\u5b9a\u6240\u4ee5\u6703\u88ab\u653e\u5230 ",(0,i.kt)("inlineCode",{parentName:"p"},"dist")," \u8cc7\u6599\u593e\u4e2d\uff0c\u800c\u6211\u5011\u8981\u6253\u5305 Demo\u7db2\u7ad9\uff0c\u6703\u907f\u514d\u88ab\u653e\u5230\u76f8\u540c\u7684\u8cc7\u6599\u593e\u7576\u4e2d\uff0c\u6240\u4ee5\u6703\u8a2d\u5b9a\u5230\u4e0d\u540c\u7684\u8cc7\u6599\u593e\u4e2d\u3002"),(0,i.kt)("p",null,"\u4ee5\u5f80 Webpack \u662f\u8a2d\u5b9a\u5728 ",(0,i.kt)("inlineCode",{parentName:"p"},"outputDir")," \u6b04\u4f4d\u4e2d\uff0c vite \u662f\u5728",(0,i.kt)("inlineCode",{parentName:"p"},"vite.config.ts")," \u4e2d\u8a2d\u5b9a ",(0,i.kt)("inlineCode",{parentName:"p"},"outDir")," \u6b04\u4f4d\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"build: {\n  outDir: 'demo'\n}\n")),(0,i.kt)("h3",{id:"demo\u9801\u548cpackage\u7684\u6253\u5305\u5206\u958b\u4f86"},"Demo\u9801\u548cPackage\u7684\u6253\u5305\u5206\u958b\u4f86"),(0,i.kt)("p",null,"\u4ee5\u9019\u500b\u9700\u6c42\u4f86\u8aaa\u6211\u5011\u9700\u8981\u5206\u5225\u6253\u5305\u51fa\u5169\u4efd\u7a0b\u5f0f\uff0c\u4e00\u4efd\u662f\u8981\u767c\u5e03\u4e0a npm\u7684 Node Packages\uff0c\u53e6\u4e00\u4efd\u662f\u8981\u5e03\u7f72 Demo\u7db2\u7ad9\u7684\u7a0b\u5f0f\u3002"),(0,i.kt)("p",null,"\u70ba\u4e86\u5728\u6307\u4ee4\u4e0a\u505a\u5340\u9694\uff0c",(0,i.kt)("inlineCode",{parentName:"p"},"packages.json")," \u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"scripts")," \u5167\u7684\u6307\u4ee4\u5206\u5225\u52a0\u4e0a ",(0,i.kt)("inlineCode",{parentName:"p"},"--mode")," \u53c3\u6578"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "scripts": {\n    "build:demo": "vite build --mode production-demo",\n    "build:package": "vite build --mode production-package"\n  }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"vite.config.js")," \u4e0a\u6539\u7528 callback \u7684\u5beb\u6cd5\uff0c\u900f\u904e\u6ce8\u5165\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"mode")," \u53c3\u6578\u5224\u65b7\u57f7\u884c\u7684\u662f\u54ea\u500b\u6307\u4ee4 (mode) \u7136\u5f8c\u56de\u50b3\u76f8\u5c0d\u61c9\u7684\u8a2d\u5b9a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"export default defineConfig(({ command, mode }) => {\n\n  if (mode === 'production-package') {\n    return buildPackageConfig\n  } else {\n    return buildDemoConfig\n  }\n\n})\n")),(0,i.kt)("p",null,"\u5b8c\u6574\u7684\u7bc4\u4f8b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import { fileURLToPath, URL } from 'node:url'\n\nimport { resolve } from 'path'\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport dts from 'vite-plugin-dts'\n\nconst buildDemoConfig = {\n  plugins: [\n    vue()\n  ],\n  base: '/my-library/demo',\n  resolve: {\n    alias: {\n      '@': fileURLToPath(new URL('./src', import.meta.url))\n    }\n  },\n  build: {\n    outDir: 'demo'\n  },\n  server: {\n    host: '0.0.0.0'\n  }\n}\n\nconst buildPackageConfig = {\n  plugins: [\n    vue(),\n    dts({\n      cleanVueFileName: true,\n      insertTypesEntry: true,\n      aliasesExclude: ['src/views']\n    })\n  ],\n  resolve: {\n    alias: {\n      '@': fileURLToPath(new URL('./src', import.meta.url))\n    }\n  },\n  build: {\n    lib: {\n      entry: \"src/main.ts\",\n      name: 'myLibrary',\n      formats: [\"es\", \"cjs\", \"umd\"],\n      fileName: (format: string) => `my-library.${format}.js`\n    },\n    rollupOptions: {\n      input: {\n        main: resolve(__dirname, \"src/main.ts\")\n      },\n      external: ['vue'],\n      output: {\n        assetFileNames: 'my-library.css',\n        exports: \"named\",\n        globals: {\n          vue: 'Vue',\n        },\n      },\n    },\n  },\n}\n\nexport default defineConfig(({ command, mode }) => {\n\n  if (mode === 'production-package') {\n    return buildPackageConfig\n  } else {\n    return buildDemoConfig\n  }\n\n})\n")),(0,i.kt)("h2",{id:"reference"},"Reference"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://medium.com/@blaster203/how-to-create-a-component-library-with-vue-3-vitejs-typescript-8eb41f799045"},"How to create a component library with Vue 3 + ViteJS + TypeScript?")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://segmentfault.com/a/1190000012419990"},"JS\u6a21\u5757\u89c4\u8303\uff1aAMD\u3001UMD\u3001CMD\u3001commonJS\u3001ES6 module")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://juejin.cn/post/7246638858912989241"},"Vue3 + Vite + Ts\u81ea\u5df1\u5c01\u88c5\u7684\u57fa\u7840\u7ec4\u4ef6\u5e93\u53d1\u5e03npm \uff0cnpm\u5b89\u88c5\u4f7f\u7528\uff08Volar \uff09\u652f\u6301TS \u7c7b\u578b\u63d0\u793a\u529f\u80fd\uff08vite-plugin-dts \u4f7f\u7528\uff09")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/SunshowerC/blog/issues/8"},"package.json \u4e2d \u4f60\u8fd8\u4e0d\u6e05\u695a\u7684 browser\uff0cmodule\uff0cmain \u5b57\u6bb5\u4f18\u5148\u7ea7")))}u.isMDXComponent=!0}}]);